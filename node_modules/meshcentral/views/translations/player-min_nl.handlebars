<!doctypehtml><html lang=nl dir=ltr xmlns=http://www.w3.org/1999/xhtml><meta http-equiv=X-UA-Compatible content="IE=edge"><meta content="text/html;charset=utf-8"http-equiv=Content-Type><meta name=viewport content="user-scalable=1,initial-scale=1,minimum-scale=1,maximum-scale=1"><meta name=apple-mobile-web-app-capable content=yes><meta name=format-detection content="telephone=no"><link type=text/css href=styles/style.css media=screen rel=stylesheet title=CSS><link rel=apple-touch-icon href=/favicon-303x303.png><script src=scripts/common-0.0.1{{min}}.js></script><script src=scripts/agent-desktop-0.0.2{{min}}.js></script><script src=scripts/amt-desktop-0.0.2{{min}}.js></script><script src=scripts/amt-terminal-0.0.2{{min}}.js></script><script src=scripts/zlib{{min}}.js></script><script src=scripts/zlib-inflate{{min}}.js></script><script src=scripts/zlib-adler32{{min}}.js></script><script src=scripts/zlib-crc32{{min}}.js></script><body style=overflow:hidden;background-color:#000><div id=p11 class=noselect style=overflow:hidden><div id=deskarea0><div id=deskarea1 class=areaHead><div class=toright2><div class=deskareaicon title="Schakel weergavemodus"onclick=toggleAspectRatio(1)>⇲</div></div><div><input id=OpenFileButton type=button value="Open bestand..."onclick=openfile()> <span id=deskstatus></span></div></div><div id=deskarea3x style="max-height:calc(100vh - 58px);height:calc(100vh - 58px)"onclick=togglePause()><div id=bigok style="display:none;left:calc((100vh / 2))"><b>✓</b></div><div id=bigfail style="display:none;left:calc((100vh / 2))"><b>✗</b></div><div id=metadatadiv style=padding:20px;color:#d3d3d3;text-align:left;display:none></div><div id=DeskParent><canvas id=Desk width=640 height=480></canvas></div><div id=TermParent style=display:none><pre id=Term></pre></div><div id=p11DeskConsoleMsg style=display:none;cursor:pointer;position:absolute;left:30px;top:17px;color:#ff0;background-color:rgba(0,0,0,.6);padding:10px;border-radius:5px onclick=clearConsoleMsg()></div></div><div id=deskarea2><div class=areaProgress style=cursor:pointer onclick=progressBarSeek(event)><div id=progressbar style=height:6px;cursor:pointer></div></div></div><div id=deskarea4 class=areaFoot><div class=toright2><div id=timespan style=padding-top:4px;padding-right:4px>00:00:00</div></div><div>&nbsp; <input id=PlayButton type=button value=Afspelen disabled onclick=play()> <input id=PauseButton type=button value=Pause disabled onclick=pause()> <input id=RestartButton type=button value=Herstarten disabled onclick=restart()> <select id=PlaySpeed onchange=this.blur()><option value=4>1/4 snelheid<option value=2>1/2 snelheid<option value=1 selected>Normale snelheid<option value=0.5>2x Snelheid<option value=0.25>4x snelheid<option value=0.1>10x Snelheid</select> <input id=SeekBackwardButton type=button value="<<"disabled onclick=seekBackward()> <input id=SeekForwardButton type=button value=">>"disabled onclick=seekForward()></div></div></div><div id=dialog class=noselect style=display:none><div id=dialogHeader><div tabindex=0 id=id_dialogclose onclick=setDialogMode() onkeypress='"Enter"==event.key&&setDialogMode()'>✖</div><div id=id_dialogtitle></div></div><div id=dialogBody><div id=dialog1><div id=id_dialogMessage></div></div><div id=dialog2><div id=id_dialogOptions></div></div></div><div id=idx_dlgButtonBar><input id=idx_dlgCancelButton type=button value=Annuleren onclick=dialogclose(0)> <input id=idx_dlgOkButton type=button value=OK onclick=dialogclose(1)><div><input id=idx_dlgDeleteButton type=button value=Verwijderen style=display:none onclick=dialogclose(2)></div></div></div></div><script>var recFile=null,recFilePtr=0,recFileStartTime=0,recFileLastTime=0,recFileEndTime=0,recFileMetadata=null,recFileProtocol=0,recFileIndexBasePtr=null,recFileExtras=null,agentDesktop=null,amtDesktop=null,playing=!1,readState=0,waitTimer=null,waitTimerArgs=null,deskAspectRatio=0,currentDeltaTimeTotalSec=0;function start(){window.onresize=deskAdjust,document.ondrop=ondrop,document.ondragover=ondragover,document.ondragleave=ondragleave,document.onkeypress=onkeypress,Q("PlaySpeed").value=1,cleanup()}function readNextBlock(l){if(recFilePtr+16>recFile.size)QS("progressbar").width="100%",l(-1);else{var e=new FileReader;e.onload=function(){var e=ReadShort(this.result,0),t=ReadShort(this.result,2),a=ReadInt(this.result,4),r=(ReadInt(this.result,8)<<32)+ReadInt(this.result,12);if(recFilePtr+16+a>recFile.size)QS("progressbar").width="100%",l(-1);else{var i=new FileReader;i.onload=function(){recFilePtr+=16+a,QS("progressbar").width=0==recFileEndTime?Math.floor(recFilePtr/recFile.size*100)+"%":Math.floor((recFileLastTime-recFileStartTime)/(recFileEndTime-recFileStartTime)*100)+"%",l(e,t,r,this.result)},i.readAsBinaryString(recFile.slice(recFilePtr+16,recFilePtr+16+a))}},e.readAsBinaryString(recFile.slice(recFilePtr,recFilePtr+16))}}function readBlockAt(l,n){var e=new FileReader;e.onload=function(){var e=ReadShort(this.result,0),t=ReadShort(this.result,2),a=ReadInt(this.result,4),r=(ReadInt(this.result,8)<<32)+ReadInt(this.result,12);if(l+16+a>recFile.size)n(-1);else{var i=new FileReader;i.onload=function(){n(e,t,r,this.result)},i.readAsBinaryString(recFile.slice(l+16,l+16+a))}},e.readAsBinaryString(recFile.slice(l,l+16))}function readLastBlock(n){if(recFile.size<32)n(-1);else{var e=new FileReader;e.onload=function(){var a=ReadShort(this.result,0),r=ReadShort(this.result,2),e=ReadInt(this.result,4),t=(ReadInt(this.result,8)<<32)+ReadInt(this.result,12),i=this.result.substring(16,32);if(3==a&&16==e&&"MeshCentralMCNDX"==i){var l=new FileReader;l.onload=function(){ReadShort(this.result,0),ReadShort(this.result,2),ReadInt(this.result,4);var e=(ReadInt(this.result,8)<<32)+ReadInt(this.result,12),t=JSON.parse(this.result.substring(16));n(a,r,e,t)},l.readAsBinaryString(recFile.slice(t,recFile.size-32))}else 3==a&&16==e&&"MeshCentralMCREC"==i?n(a,r,t):n(-1)},e.readAsBinaryString(recFile.slice(recFile.size-32,recFile.size))}}function addInfo(e,t){return null==t?"":addInfoNoEsc(e,EscapeHtml(t))}function addInfoNoEsc(e,t){return null==t?"":"<span style=color:gray>"+EscapeHtml(e)+"</span>:&nbsp;<span style=font-size:20px>"+t+"</span><br/>"}function processFirstBlock(e,t,a,r){if(recFileProtocol=0,1!=e||2<t)cleanup();else{try{recFileMetadata=JSON.parse(r)}catch(e){return void cleanup()}if(null!=recFileMetadata&&"MeshCentralRelaySession"==recFileMetadata.magic&&1==recFileMetadata.ver){if(recFileExtras)for(var i in recFileExtras)recFileMetadata[i]=recFileExtras[i];var l="";if(l+=addInfo("Tijd",recFileMetadata.time),0!=recFileEndTime){var n=Math.floor((recFileEndTime-a)/1e3);l+=addInfo("Looptijd",format("{0} seconde{1}",n,1<n?"s":""))}if(l+=addInfo("Gebruikersnaam",recFileMetadata.username),l+=addInfo("GebruikersID",recFileMetadata.userid),l+=addInfo("SessieID",recFileMetadata.sessionid),recFileMetadata.ipaddr1&&recFileMetadata.ipaddr2&&(l+=addInfo("Adressen",format("{0} tot {1}",recFileMetadata.ipaddr1,recFileMetadata.ipaddr2))),recFileMetadata.devicename&&(l+=addInfo("Apparaat naam",recFileMetadata.devicename)),l+=addInfo("NodeID",recFileMetadata.nodeid),recFileMetadata.protocol){var s=recFileMetadata.protocol;1==s?s="MeshCentral Terminal":2==s?s="MeshCentral Desktop":100==s?s="Intel&reg; AMT WSMAN":101==s?s="Intel&reg; AMT omleiding":200==s&&(s="Intel&reg; AMT KVM"),l+=addInfoNoEsc("Protocol",s)}1==recFileMetadata.bpp&&(l+=addInfoNoEsc("Kleurkwaliteit","256 kleuren")),2==recFileMetadata.bpp&&(l+=addInfoNoEsc("Kleurkwaliteit","65536 kleuren")),recFileMetadata.indexInterval?(recFileIndexBasePtr=recFilePtr,l+=addInfoNoEsc("Op zoek naar",format("Geïndexeerd om de {0} seconden",recFileMetadata.indexInterval)),QV("SeekBackwardButton",!0),QV("SeekForwardButton",!0),QE("SeekBackwardButton",!0),QE("SeekForwardButton",!0)):(QV("SeekBackwardButton",!1),QV("SeekForwardButton",!1)),QV("DeskParent",!0),QV("TermParent",!1),1==recFileMetadata.protocol?(recFileProtocol=1,l+="<br /><br /><span style=color:gray>Druk op [spatie] om te spelen / pauzeren.</span>",QE("PlayButton",!0),QE("PauseButton",!1),QE("RestartButton",!1),recFileStartTime=recFileLastTime=a):2==recFileMetadata.protocol?(recFileProtocol=2,l+="<br /><br /><span style=color:gray>Druk op [spatie] om te spelen / pauzeren.</span>",QE("PlayButton",!0),QE("PauseButton",!1),QE("RestartButton",!1),recFileStartTime=recFileLastTime=a,(agentDesktop=CreateAgentRemoteDesktop("Desk")).onScreenSizeChange=deskAdjust,agentDesktop.State=3,deskAdjust()):101==recFileMetadata.protocol?(recFileProtocol=101,l+="<br /><br /><span style=color:gray>Druk op [spatie] om te spelen / pauzeren.</span>",QE("PlayButton",!0),QE("PauseButton",!1),QE("RestartButton",!1),recFileStartTime=recFileLastTime=a,(amtDesktop=CreateAmtRemoteDesktop("Desk")).onScreenSizeChange=deskAdjust,recFileMetadata.bpp&&(amtDesktop.bpp=recFileMetadata.bpp),amtDesktop.State=3,amtDesktop.Start(),deskAdjust()):200==recFileMetadata.protocol&&(recFileProtocol=200,l+="<br /><br /><span style=color:gray>Druk op [spatie] om te spelen / pauzeren.</span>",QE("PlayButton",!0),QE("PauseButton",!1),QE("RestartButton",!1),recFileStartTime=recFileLastTime=a,(amtDesktop=CreateAmtRemoteDesktop("Desk")).onScreenSizeChange=deskAdjust,amtDesktop.State=3,amtDesktop.Start(),recFileMetadata.bpp&&(amtDesktop.bpp=recFileMetadata.bpp),amtDesktop.state=3,deskAdjust()),QV("metadatadiv",!0),QH("metadatadiv",l),QH("deskstatus",recFile.name),QS("progressbar").width="0px"}else cleanup()}}function processBlock(e,t,a,r){if(e<0)pause();else{var i=Math.round((a-recFileLastTime)*parseFloat(Q("PlaySpeed").value));i<5?processBlockEx(e,t,a,r):(waitTimerArgs=[e,t,a,r],waitTimer=setTimeout(function(){waitTimer=null,waitTimerArgs&&processBlockEx(waitTimerArgs[0],waitTimerArgs[1],waitTimerArgs[2],waitTimerArgs[3])},i))}}function processBlockEx(e,t,a,r,i){if(0!=playing||!0===i){var l=0!=(1&t),n=0!=(2&t);if(2==e){recFileLastTime=a;var s=Math.floor((a-recFileStartTime)/1e3);if(currentDeltaTimeTotalSec!=s){currentDeltaTimeTotalSec=s;var o=Math.floor(s/3600),d=Math.floor(s%3600/60),c=Math.floor(s%60);QH("timespan",pad2(o)+":"+pad2(d)+":"+pad2(c))}}if(2==e&&l&&!n){if(1==recFileProtocol)agentTerminal.ProcessData(r);else if(2==recFileProtocol){for(var u=new Uint8Array(r.length),p=0;p<r.length;p++)u[p]=r.charCodeAt(p);var k=(u[0]<<8)+u[1],g=(u[2]<<8)+u[3];27==k&&8==g&&(k=(u[8]<<8)+u[9],g=(u[5]<<16)+(u[6]<<8)+u[7],u=u.slice(8)),g!=u.byteLength?console.log("Bad command size",k,g,u.byteLength):agentDesktop.ProcessBinaryCommand(k,g,u.slice(0,g))}else if(101==recFileProtocol){for(u=new Uint8Array(r.length),p=0;p<r.length;p++)u[p]=r.charCodeAt(p);0==readState&&"4100000000000000"==rstr2hex(r)?(readState=1,8<r.length&&amtDesktop.ProcessBinaryData(u.slice(8).buffer)):1==readState&&amtDesktop.ProcessBinaryData(u.buffer)}else if(200==recFileProtocol){for(u=new Uint8Array(r.length),p=0;p<r.length;p++)u[p]=r.charCodeAt(p);amtDesktop.ProcessBinaryData(u.buffer)}}else 2==e&&l&&n&&101==recFileProtocol&&"0000000008080001000700070003050200000000"==rstr2hex(r)&&(amtDesktop.bpp=1);if(3==e&&200==recFileProtocol){var m=new Image;m.src="data:image/png;base64,"+btoa(r),m.onload=function(){amtDesktop.canvas.drawImage(m,0,0)},m.error=function(){}}playing&&readNextBlock(processBlock)}}function cleanup(){recFilePtr=0,playing=!1,(recFileMetadata=recFile=null)!=agentDesktop&&(agentDesktop.Canvas.clearRect(0,0,agentDesktop.CanvasId.width,agentDesktop.CanvasId.height),agentDesktop=null),null!=amtDesktop&&(amtDesktop.canvas.clearRect(0,0,amtDesktop.CanvasId.width,amtDesktop.CanvasId.height),amtDesktop=null),recFileEndTime=currentDeltaTimeTotalSec=readState=0,(agentTerminal=waitTimerArgs=null)!=waitTimer&&(clearTimeout(waitTimer),waitTimer=null),QH("deskstatus",""),QE("PlayButton",!1),QE("PauseButton",!1),QE("RestartButton",!1),QE("SeekBackwardButton",!1),QE("SeekForwardButton",!1),QS("progressbar").width="0px",QH("timespan","00:00:00"),QV("metadatadiv",!0),QH("metadatadiv",'<span style="font-family:Arial,Helvetica Neue,Helvetica,sans-serif;font-size:28px">MeshCentral Session Player</span><br /><br /><span style=color:gray>Sleep een .mcrec-bestand of klik op "Bestand openen ..."</span>'),QV("DeskParent",!0),QV("TermParent",!1)}function ondrop(e){if(haltEvent(e),QV("bigfail",!1),QV("bigok",!1),null!=e.dataTransfer){var t=[];for(var a in e.dataTransfer.files)null!=e.dataTransfer.files[a].type&&null!=e.dataTransfer.files[a].size&&0!=e.dataTransfer.files[a].size&&e.dataTransfer.files[a].name.endsWith(".mcrec")&&t.push(e.dataTransfer.files[a]);0!=t.length&&(cleanup(),recFile=t[0],recFilePtr=0,readLastBlock(function(e,t,a,r){3==e?(recFileEndTime=a,recFileExtras=r,readNextBlock(processFirstBlock)):recFileEndTime=0}))}}var SeekIndex,SeekIndexPtr,SeekIndexTime,SeekPlayState,xxdialogMode,xxdialogFunc,xxdialogButtons,xxdialogTag,dragtimer=null;function ondragover(e){haltEvent(e),null!=dragtimer&&(clearTimeout(dragtimer),dragtimer=null);QV("bigok",!0),QV("bigfail",!1)}function ondragleave(e){haltEvent(e),dragtimer=setTimeout(function(){QV("bigfail",!1),QV("bigok",!1),dragtimer=null},10)}function onkeypress(e){xxdialogMode||(" "==e.key&&(togglePause(),haltEvent(e)),"1"==e.key&&(Q("PlaySpeed").value=4,haltEvent(e)),"2"==e.key&&(Q("PlaySpeed").value=2,haltEvent(e)),"3"==e.key&&(Q("PlaySpeed").value=1,haltEvent(e)),"4"==e.key&&(Q("PlaySpeed").value=.5,haltEvent(e)),"5"==e.key&&(Q("PlaySpeed").value=.25,haltEvent(e)),"6"==e.key&&(Q("PlaySpeed").value=.1,haltEvent(e)),"0"==e.key&&(pause(),restart(),haltEvent(e)))}function openfile(){setDialogMode(2,"Open bestand...",3,openfileEx,'<input type=file name=files id=p2fileinput style=width:100% accept=".mcrec" onchange="openfileChanged()" />'),QE("idx_dlgOkButton",!1)}function openfileEx(){var e=Q("p2fileinput").files;if(null!=e){var t=[];for(var a in e)null!=e[a].type&&null!=e[a].size&&0!=e[a].size&&e[a].name.endsWith(".mcrec")&&t.push(e[a])}0!=t.length&&(cleanup(),recFile=t[0],recFilePtr=0,readLastBlock(function(e,t,a,r){3==e?(recFileEndTime=a,recFileExtras=r,readNextBlock(processFirstBlock)):recFileEndTime=0}),Q("OpenFileButton").blur())}function openfileChanged(){var e=Q("p2fileinput").files;if(null!=e){var t=[];for(var a in e)null!=e[a].type&&null!=e[a].size&&0!=e[a].size&&e[a].name.endsWith(".mcrec")&&t.push(e[a])}QE("idx_dlgOkButton",1==t.length)}function togglePause(){return null!=recFile&&(1==playing?pause():recFilePtr!=recFile.size&&play()),!1}function play(){Q("PlayButton").blur(),1!=playing&&0!=recFileProtocol&&(playing=!0,QV("metadatadiv",!1),QE("PlayButton",!1),QE("PauseButton",!0),QE("RestartButton",!1),1==recFileProtocol&&null==agentTerminal&&(QV("DeskParent",!1),QV("TermParent",!0),agentTerminal=CreateAmtRemoteTerminal("Term",{}),agentTerminal.State=3),readNextBlock(processBlock))}function pause(){Q("PauseButton").blur(),0!=playing&&(playing=!1,QE("PlayButton",recFilePtr!=recFile.size),QE("PauseButton",!1),QE("RestartButton",0!=recFilePtr),null!=waitTimer&&(clearTimeout(waitTimer),waitTimer=null,processBlockEx(waitTimerArgs[0],waitTimerArgs[1],waitTimerArgs[2],waitTimerArgs[3]),waitTimerArgs=null))}function restart(){Q("RestartButton").blur(),1!=playing&&(currentDeltaTimeTotalSec=readState=recFilePtr=0,QV("metadatadiv",!0),QE("PlayButton",!0),QE("PauseButton",!1),QE("RestartButton",!1),QS("progressbar").width="0px",QH("timespan","00:00:00"),QV("DeskParent",!0),QV("TermParent",!1),agentDesktop?agentDesktop.Canvas.clearRect(0,0,agentDesktop.CanvasId.width,agentDesktop.CanvasId.height):amtDesktop?(amtDesktop.canvas.clearRect(0,0,amtDesktop.CanvasId.width,amtDesktop.CanvasId.height),(amtDesktop=CreateAmtRemoteDesktop("Desk")).onScreenSizeChange=deskAdjust,amtDesktop.State=3,amtDesktop.Start(),200==recFileMetadata.protocol&&(recFileMetadata.bpp&&(amtDesktop.bpp=recFileMetadata.bpp),amtDesktop.state=3)):agentTerminal=agentTerminal&&null)}function clearConsoleMsg(){QH("p11DeskConsoleMsg","")}function toggleAspectRatio(e){1===e&&(deskAspectRatio=(deskAspectRatio+1)%3),deskAdjust()}function deskAdjust(){var e=Q("DeskParent").clientHeight,t=Q("DeskParent").clientWidth,a=Q("Desk").height,r=Q("Desk").width;if(2==deskAspectRatio)QS("Desk")["margin-top"]=null,QS("Desk").height="100%",QS("Desk").width="100%",QS("DeskParent").overflow="hidden";else if(1==deskAspectRatio)QS("Desk")["margin-top"]="0px",QS("Desk").height=a+"px",QS("Desk").width=r+"px",QS("DeskParent").overflow="scroll";else{if(a/r<e/t){var i=a*t/r+"px";QS("Desk").height=i,QS("Desk").width="100%"}else{var l=r*e/a+"px";QS("Desk").height="100%",QS("Desk").width=l}QS("Desk")["margin-top"]=null,QS("DeskParent").overflow="hidden"}}function seekBackward(){var e=Math.round(currentDeltaTimeTotalSec/recFileMetadata.indexInterval);e<2?(pause(),restart()):null!=recFileMetadata.indexes[e-2]&&seek(e-2)}function seekForward(){var e=Math.round(currentDeltaTimeTotalSec/recFileMetadata.indexInterval);null!=recFileMetadata.indexes[e]&&seek(e)}function progressBarSeek(e){var t=Math.round(e.clientX/document.body.offsetWidth*(recFileMetadata.indexes.length+1))-1;-1==t?(pause(),restart()):seek(t)}function seek(e){if(null==recFileMetadata.indexes||null==recFileMetadata.indexes[e])return null;SeekPlayState=playing,pause(),restart(),SeekIndex=recFileMetadata.indexes[e],SeekIndexPtr=3,recFileLastTime=SeekIndexTime=recFileStartTime+(1+e)*recFileMetadata.indexInterval*1e3,recFilePtr=recFileIndexBasePtr+SeekIndex[0];var t=SeekIndex[1],a=SeekIndex[2];QS("progressbar").width=0==recFileEndTime?Math.floor(recFilePtr/recFile.size*100)+"%":Math.floor((recFileLastTime-recFileStartTime)/(recFileEndTime-recFileStartTime)*100)+"%",agentDesktop&&(agentDesktop.Canvas.clearRect(0,0,agentDesktop.CanvasId.width,agentDesktop.CanvasId.height),agentDesktop.ProcessScreenMsg(t,a)),QV("metadatadiv",!1),QV("Desk",!1),seekFetchNext(function(){QV("Desk",!0),SeekPlayState&&play()})}function seekFetchNext(i){null!=SeekIndex[SeekIndexPtr]?readBlockAt(recFileIndexBasePtr+SeekIndex[SeekIndexPtr],function(e,t,a,r){SeekIndexPtr++,processBlockEx(e,t,SeekIndexTime,r,!0),seekFetchNext(i)}):i()}var xxcurrentView=-1;function setDialogMode(e,t,a,r,i,l){xxdialogMode=e,xxdialogFunc=r,xxdialogButtons=a,xxdialogTag=l,QE("idx_dlgOkButton",!0),QV("idx_dlgOkButton",1&a),QV("idx_dlgCancelButton",2&a),QV("id_dialogclose",2&a||8&a),QV("idx_dlgDeleteButton",4&a),QV("idx_dlgButtonBar",7&a),t&&QH("id_dialogtitle",t);for(var n=1;n<3;n++)QV("dialog"+n,n==e);QV("dialog",e),i&&(2==e?QH("id_dialogOptions",i):QH("id_dialogMessage",i))}function dialogclose(e){var t=xxdialogFunc,a=xxdialogButtons,r=xxdialogTag;setDialogMode(),(8&a||e)&&t&&t(e,r)}function messagebox(e,t){setSessionActivity(),QH("id_dialogMessage",t),setDialogMode(1,e,1)}function statusbox(e,t){setSessionActivity(),QH("id_dialogMessage",t),setDialogMode(1,e)}function haltEvent(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}function pad2(e){var t="00"+e;return t.substr(t.length-2)}function format(e){var a=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,function(e,t){return void 0!==a[t]?a[t]:e})}start()</script>